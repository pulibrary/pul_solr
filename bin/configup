#!/bin/sh

DIR=./solr_configs/$1/conf
CONFIG_SET=$2

if [ ! "$1" -o ! "$2" ]; then
  echo "usage: $0 [core name] [configset name]"
  exit 1
fi

if [ ! -d $DIR ]; then
  echo "Can't find solr config directory: $DIR"
  exit 1
fi

(cd $DIR && zip -r - *) > tmp/$1.zip

curl -X POST --header "Content-Type:application/octet-stream" --data-binary @tmp/$1.zip "http://localhost:8983/solr/admin/configs?action=UPLOAD&name=$CONFIG_SET"
